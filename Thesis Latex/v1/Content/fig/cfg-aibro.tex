\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,
	node distance=2.5cm,
	semithick,scale=0.8, transform shape,scale=0.6, font=\huge]
	
	\tikzstyle{every state}=[rectangle,
	minimum height = 1cm, text width=3.5cm, text centered, 
	fill=blue!20,draw=none,text=black, draw,line width=0.3mm, font=\LARGE]
	
	%start state
	\node[state]
	(init) 
	{$f$: \\init, \textit{fork}}; 
	
	\node[state]
	(awaitA) [below of=init] 
	{$a_1$: \\await \texttt{A}};
	
	\node[state]
	(frontA) [below of=awaitA] 
	{$a_2$: \\frontSensors()};
	
	\node[state]
	(awaitB) [below of=frontA]
	{$b_1$: \\await \texttt{B}};
	
	\node[state]
	(sideB) [below of=awaitB]
	{$b_2$: \\sideSensors()};
	
	\node[state]
	(awaitJoin) [below of=sideB] 
	{$j$: \\ \textit{await join}};
	
	\node[state]
	(decisionC) [below of=awaitJoin] 
	{$c$: \\runDecision()};
	%\node[draw=none]
	%(inv) [below of=init]
	%{};
	
	%\node[draw=none]
	%(inv2) [below of=inv]
	%{};
		
	

	
	\path[->] (init) edge (awaitA);
	\path[->] (awaitA) edge (frontA);
	\path[->] (frontA) edge (awaitB);
	\path[->] (awaitB) edge (sideB);
	\path[->] (sideB) edge (awaitJoin);
	\path[->] (awaitJoin) edge (decisionC);
	
	\draw[->] (decisionC.south) 
		|- ($(decisionC.south) + (0, -1cm)$) 
		-| ($(decisionC.east) + (2.5cm, 0)$) 
		|- ($(init.east) + (0, 1.5cm)$) 
		-| (init.north);
		
	\draw[->] (awaitA.west) 
		-| ($(awaitA.west) + (-1cm, 0)$)
		|- ($(awaitB.west) + (-1cm, 0)$)
		%|- ($(awaitA.160) + (0, 0.75cm)$) 
		|- (awaitB.west);
		
	\draw[->] (awaitA.west) 
		-| ($(awaitA.west) + (-1cm, 0)$)
		|- ($(awaitB.west) + (-1cm, 0)$)
		%|- ($(awaitA.160) + (0, 0.75cm)$) 
		|- (awaitJoin.west);
		
	\draw[->] (awaitB.east) 
		|- ($(awaitB.east) + (2.5cm, 0)$);
		
	\draw[->] (awaitJoin.east) 
	|- ($(awaitJoin.east) + (2.5cm, 0)$);
	
	%\draw[->] (decisionC.south) 
	%	|- ($(decisionC.south) + (0, -1cm)$) 
	%	-| ($(decisionC.east) + (4.5cm, 0)$) 
	%	|- ($(init.east) + (0, 1.5cm)$) 
	%	-| (init.north);
	
	%\draw[->] (awaitA.200) 
	%	|- ($(awaitA.200) + (0, -0.75cm)$) 
	%	-| ($(awaitA.200) + (-2cm, 0)$)
	%	|- ($(awaitA.160) + (0, 0.75cm)$) 
	%	-| (awaitA.160);
		
	%\draw[->] (awaitB.340) 
	%|- ($(awaitB.340) + (0, -0.75cm)$) 
	%-| ($(awaitB.340) + (2cm, 0)$)
	%|- ($(awaitB.20) + (0, 0.75cm)$) 
	%-| (awaitB.20);
	
	%\draw[->] (awaitJoin.195) 
	%|- ($(awaitJoin.195) + (0, -0.75cm)$) 
	%-| ($(awaitJoin.195) + (-1.5cm, 0)$)
	%|- ($(awaitJoin.165) + (0, 0.75cm)$) 
	%-| (awaitJoin.165);
	
	
\end{tikzpicture}
